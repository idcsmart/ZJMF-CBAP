<link rel="stylesheet" href="/plugins/server/mf_cloud/template/admin/css/mf-cloud.css">

<!-- =======内容区域======= -->
<div class="common_config">
  <com-config>
    <div class="t-card">
      <t-tabs v-model="tabs" @change="changeTab">
        <!-- 周期设置 -->
        <t-tab-panel value="duration" :label="lang.mf_duration">
          <div class="box limit-table">
            <div class="com-top">
              <p class="tit">{{lang.mf_duration}}</p>
              <div class="right">
                <div class="add-btn" @click='changeRadio'>{{lang.cycle_ratio}}</div>
                <div class="add-btn" @click='addCycle'>{{lang.add_cycle}}</div>
              </div>
            </div>
            <p class="s-tip" style="line-height: 1;margin-top: -10px;">{{lang.mf_tip30}}</p>
            <t-table row-key="id" :data="cycleData" size="medium" :columns="cycleColumns" :hover="hover"
              :loading="loading" :table-layout="tableLayout ? 'auto' : 'fixed'" display-type="fixed-width"
              :hide-sort-tips="true">
              <template slot="sortIcon">
                <t-icon name="caret-down-small"></t-icon>
              </template>
              <template #price_factor="{row}">
                {{row.price_factor.toFixed(2)}}
              </template>
              <template #unit="{row}">
                <span v-if="row.num">{{row.num}}</span>{{lang[row.unit]}}
              </template>
              <template #price="{row}">
                <span>{{currency_prefix}}{{(row.price*1).toFixed(2)}}</span>
              </template>
              <template #ratio="{row}">
                <span>{{row.ratio || '--'}}</span>
              </template>
              <template #op="{row}">
                <div class="com-opt">
                  <t-tooltip :content="lang.edit" :show-arrow="false" theme="light">
                    <t-icon name="edit-1" @click="editCycle(row)"></t-icon>
                  </t-tooltip>
                  <t-tooltip :content="lang.delete" :show-arrow="false" theme="light">
                    <t-icon name="delete" @click="comDel('cycle',row)"></t-icon>
                  </t-tooltip>
                </div>
              </template>
            </t-table>
          </div>
        </t-tab-panel>
        <!-- 计算配置 -->
        <t-tab-panel value="calc" :label="lang.mf_calc">
          <div class="box limit-table" v-if="lang">
            <div class="com-top">
              <p class="tit">{{lang.cpu_config}}</p>
              <div class="add-btn" @click="addCalc('cpu')">{{lang.order_text53}}CPU</div>
            </div>
            <t-table row-key="id" :data="cpuList" size="medium" :columns="cpuColumns" :hover="hover"
              :loading="cpuLoading" :table-layout="tableLayout ? 'auto' : 'fixed'" display-type="fixed-width"
              :hide-sort-tips="true">
              <template slot="sortIcon">
                <t-icon name="caret-down-small"></t-icon>
              </template>
              <template #value="{row}">
                {{row.value}}
              </template>
              <template #price="{row}">
                <span>{{currency_prefix}}{{(row.price*1).toFixed(2)}}</span>
                <template v-if="row.duration">/{{row.duration}}</template>
                &nbsp;{{lang.rise}}
              </template>
              <template #op="{row}">
                <div class="com-opt">
                  <t-tooltip :content="lang.edit" :show-arrow="false" theme="light">
                    <t-icon name="edit-1" @click="editCalc(row, 'cpu')"></t-icon>
                  </t-tooltip>
                  <t-tooltip :content="lang.delete" :show-arrow="false" theme="light">
                    <t-icon name="delete" @click="comDel('c_cpu',row)"></t-icon>
                  </t-tooltip>
                </div>
              </template>
            </t-table>
            <div class="com-top" style="margin-top: 30px;">
              <p class="tit">
                {{lang.memory_config}}<template v-if="memoryType">-{{memoryType}}{{lang.mf_way}}</template>
              </p>
              <div class="add-btn" @click="addCalc('memory')">{{lang.order_text53}}{{lang.memory}}</div>
            </div>
            <t-table row-key="id" :data="memoryList" size="medium" :columns="calcMemeryColumns" :hover="hover"
              :loading="memoryLoading" :table-layout="tableLayout ? 'auto' : 'fixed'" display-type="fixed-width"
              :hide-sort-tips="true">
              <template slot="sortIcon">
                <t-icon name="caret-down-small"></t-icon>
              </template>
              <template #value="{row}">
                <template v-if="row.type === 'radio'">
                  {{row.value}}
                </template>
                <template v-else>
                  {{row.min_value}}-{{row.max_value}}
                </template>
              </template>
              <template #price="{row}">
                <span>{{currency_prefix}}{{(row.price*1).toFixed(2)}}</span><template
                  v-if="row.duration">/{{row.duration}}</template>
                &nbsp;{{lang.rise}}
              </template>
              <template #op="{row}">
                <div class="com-opt">
                  <t-tooltip :content="lang.edit" :show-arrow="false" theme="light">
                    <t-icon name="edit-1" @click="editCalc(row, 'memory')"></t-icon>
                  </t-tooltip>
                  <t-tooltip :content="lang.edit" :show-arrow="false" theme="light">
                    <t-icon name="delete" @click="comDel('memory',row)"></t-icon>
                  </t-tooltip>
                </div>
              </template>
            </t-table>
          </div>
        </t-tab-panel>
        <!-- 数据中心 -->
        <t-tab-panel value="data_center" :label="lang.data_center_config">
          <div class="box data-box">
            <div class="com-top">
              <p class="tit">{{lang.data_center}}</p>
              <div class="r-btn">
                <div class="add-btn" @click='addData'>{{lang.invoice_btn6}}{{lang.data_center}}</div>
                <div class="add-btn line-btn" @click='addLine'>{{lang.invoice_btn6}}{{lang.line}}</div>
              </div>
            </div>
            <t-table row-key="id" :data="dataList" size="medium" :columns="dataColumns" :hover="hover"
              :loading="dataLoading" :table-layout="tableLayout ? 'auto' : 'fixed'" display-type="fixed-width"
              :hide-sort-tips="true">
              <template slot="sortIcon">
                <t-icon name="caret-down-small"></t-icon>
              </template>
              <template #area="{row}">
                <t-tooltip :content="lang.edit" :show-arrow="false" theme="light">
                  <t-icon name="edit-1" @click.native="editData(row)"></t-icon>
                </t-tooltip>
                {{row.area}}
              </template>
              <template #line="{row}">
                <template v-if="row.line.length > 0">
                  <div class="item" v-for="(item,index) in row.line">
                    {{item.name}}
                  </div>
                </template>
                <span class="p12" v-else>--</span>
              </template>
              <template #gpu_name="{row}">
                <template v-if="row.line.length > 0">
                  <div class="item" v-for="(item,index) in row.line">
                    {{item.gpu_name || '--'}}
                  </div>
                </template>
                <span class="p12" v-else>--</span>
              </template>
              <template #price="{row}">
                <template v-if="row.line.length > 0">
                  <div class="item" v-for="(item,index) in row.line">
                    {{currency_prefix}}{{item.price}}
                    <template v-if="item.duration">/{{item.duration}}</template>
                    {{lang.rise}}&nbsp;&nbsp;{{lang['mf_'+item.bill_type]}}
                  </div>
                </template>
                <span class="p12" v-else>--</span>
              </template>
              <template #op="{row}">
                <template v-if="row.line.length > 0">
                  <div class="com-opt item" v-for="(item,index) in row.line">
                    <t-tooltip :content="lang.edit" :show-arrow="false" theme="light">
                      <t-icon name="edit-1" @click="editLine(item)"></t-icon>
                    </t-tooltip>
                    <t-tooltip :content="lang.delete" :show-arrow="false" theme="light">
                      <t-icon name="delete" @click="comDel('c_line',item)"></t-icon>
                    </t-tooltip>
                  </div>
                </template>
                <div v-else style="padding: 12px 24px;" class="com-opt">
                  <t-tooltip :content="`${lang.delete}${lang.data_center}`" :show-arrow="false" theme="light">
                    <t-icon name="delete" @click="comDel('data',row)"></t-icon>
                  </t-tooltip>
                </div>
              </template>
            </t-table>
            <div class="config-tip">
              <span class="notes">{{lang.mf_notes}}</span>
              <p class="notes-txt">
                {{lang.mf_tip6}}<br>
                {{lang.mf_tip7}}<br>
                {{lang.mf_tip8}}<br>
              </p>
            </div>
          </div>
        </t-tab-panel>
        <!-- 存储设置 -->
        <t-tab-panel value="store" :label="lang.mf_store">
          <div class="box store-box limit-table1">
            <p class="t-top">
              {{lang.mf_tip10}}<br>
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{lang.mf_tip11}}<br>
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{lang.mf_tip22}}
            </p>
            <!-- 系统盘 -->
            <div class="com-top">
              <p class="tit">
                {{lang.system_disk_config}}<template
                  v-if="systemDisk.length >0">-{{lang['mf_'+systemDisk[0].type]}}{{lang.mf_way}}</template>
              </p>
              <div class="add-btn" @click="addCalc('system_disk')">{{lang.order_text53}}{{lang.system_disk_size}}
              </div>
            </div>
            <t-table row-key="id" :data="systemDisk" size="medium" :columns="systemDiskColumns" :hover="hover"
              :loading="systemLoading" :table-layout="tableLayout ? 'auto' : 'fixed'" display-type="fixed-width"
              :hide-sort-tips="true">
              <template slot="sortIcon">
                <t-icon name="caret-down-small"></t-icon>
              </template>
              <template #value="{row}">
                <template v-if="row.type === 'radio'">
                  {{row.value}}
                </template>
                <template v-else>
                  {{row.min_value}}-{{row.max_value}}
                </template>
              </template>
              <template #price="{row}">
                <span>{{currency_prefix}}{{(row.price * 1).toFixed(2)}}</span>&nbsp;{{lang.rise}}
              </template>
              <template #type="{row}">
                {{row.other_config.disk_type || '--'}}
              </template>
              <template #op="{row}">
                <div class="com-opt">
                  <t-icon name="edit-1" @click="editCalc(row, 'system_disk')"></t-icon>
                  <t-icon name="delete" @click="comDel('system_disk',row)"></t-icon>
                </div>
              </template>
            </t-table>
            <!-- 数据盘 -->
            <div class="com-top" style="margin-top: 30px;">
              <p class="tit">
                {{lang.data_disk_config}}<template
                  v-if="dataDisk.length > 0">-{{lang['mf_'+dataDisk[0].type]}}{{lang.mf_way}}</template>
              </p>
              <div class="add-btn" @click="addCalc('data_disk')">{{lang.order_text53}}{{lang.data_disk}}</div>
            </div>
            <t-table row-key="id" :data="dataDisk" size="medium" :columns="diskColumns" :hover="hover"
              :loading="dataLoading" :table-layout="tableLayout ? 'auto' : 'fixed'" display-type="fixed-width"
              :hide-sort-tips="true">
              <template slot="sortIcon">
                <t-icon name="caret-down-small"></t-icon>
              </template>
              <template #value="{row}">
                <template v-if="row.type === 'radio'">
                  {{row.value}}
                </template>
                <template v-else>
                  {{row.min_value}}-{{row.max_value}}
                </template>
              </template>
              <template #price="{row}">
                <span>{{currency_prefix}}{{(row.price * 1).toFixed(2)}}</span>&nbsp;{{lang.rise}}
              </template>
              <template #type="{row}">
                {{row.other_config.disk_type || '--'}}
              </template>
              <template #op="{row}">
                <div class="com-opt">
                  <t-icon name="edit-1" @click="editCalc(row, 'data_disk')"></t-icon>
                  <t-icon name="delete" @click="comDel('data_disk',row)"></t-icon>
                </div>
              </template>
            </t-table>

            <!-- 数据盘新购数量限制 -->
            <div class="disk-limit-box">
              <p class="item">
                <span>{{lang.disk_limit_num}}</span>
                <t-switch :custom-value="[1,0]" v-model="otherForm.disk_limit_switch" size="small"
                  @change="changeDiskLimit($event,'switch')"></t-switch>
                <t-input-number v-model="otherForm.disk_limit_num" :min="1" :max="16" theme="normal"
                  v-show="otherForm.disk_limit_switch" :decimal-places="0" :placeholder="lang.disk_limit_tip"
                  @blur="changeDiskLimit($event,'num')"></t-input-number>
              </p>
              <p class="item">
                <span>{{lang.free_data_disk}}</span>
                <t-switch :custom-value="[1,0]" v-model="otherForm.free_disk_switch" size="small"
                  @change="changeFreeDiskLimit($event,'switch')"></t-switch>
                <t-input-number v-model="otherForm.free_disk_size" :min="1" :max="1048576" theme="normal"
                  v-show="otherForm.free_disk_switch" class="freeSuffix" :decimal-places="0"
                  :placeholder="lang.free_data_tip" @blur="changeFreeDiskLimit($event,'num')">
                </t-input-number>
                <t-tooltip :content="lang.mf_tip35 + '\n' + lang.mf_tip36" :show-arrow="false" theme="light"
                  placement="top-left">
                  <t-icon name="help-circle"></t-icon>
                </t-tooltip>
              </p>
            </div>

            <!-- 性能限制 -->
            <p class="limit">
              <span>{{lang.disk_limit_enable}}</span>
              <t-switch :custom-value="[1,0]" :value="store_limit" size="small" @change="changeLimit">
              </t-switch>
              <span v-if="store_limit">{{lang.mf_tip20}}</span>
            </p>
            <div v-show="store_limit">
              <div class="com-top">
                <p class="tit">
                  {{lang.system_disk_nature}}<template v-if="systemType">-{{systemType}}{{lang.mf_way}}</template>
                </p>
                <div class="add-btn" @click="addCalc('system_disk_limit')">
                  {{lang.order_text53}}{{lang.disk_limit_enable}}
                </div>
              </div>
              <t-table row-key="id" :data="systemLimitList" size="medium" :columns="natureColumns" :hover="hover"
                :loading="systemLimitLoading" :table-layout="tableLayout ? 'auto' : 'fixed'" display-type="fixed-width"
                :hide-sort-tips="true">
                <template slot="sortIcon">
                  <t-icon name="caret-down-small"></t-icon>
                </template>
                <template #capacity_size="{row}">
                  {{row.min_value}}-{{row.max_value}}
                </template>
                <template #price="{row}">
                  <span>{{currency_prefix}}{{row.price}}</span>&nbsp;{{lang.rise}}
                </template>
                <template #type="{row}">
                  {{row.other_config.disk_type}}
                </template>
                <template #op="{row}">
                  <div class="com-opt">
                    <t-icon name="edit-1" @click="editCalc(row, 'system_disk_limit')"></t-icon>
                    <t-icon name="delete" @click="comDel('system_disk_limit',row)"></t-icon>
                  </div>
                </template>
              </t-table>
              <div class="com-top" style="margin-top: 30px;">
                <p class="tit">
                  {{lang.data_disk_nature}}<template v-if="systemType">-{{systemType}}{{lang.mf_way}}</template>
                </p>
                <div class="add-btn" @click="addCalc('data_disk_limit')">
                  {{lang.order_text53}}{{lang.disk_limit_enable}}
                </div>
              </div>
              <t-table row-key="id" :data="diskLimitList" size="medium" :columns="natureColumns" :hover="hover"
                :loading="diskLimitLoading" :table-layout="tableLayout ? 'auto' : 'fixed'" display-type="fixed-width"
                :hide-sort-tips="true">
                <template slot="sortIcon">
                  <t-icon name="caret-down-small"></t-icon>
                </template>
                <template #capacity_size="{row}">
                  {{row.min_value}}-{{row.max_value}}
                </template>
                <template #price="{row}">
                  <span>{{currency_prefix}}{{row.price}}</span>&nbsp;{{lang.rise}}
                </template>
                <template #type="{row}">
                  {{row.other_config.disk_type}}
                </template>
                <template #op="{row}">
                  <div class="com-opt">
                    <t-icon name="edit-1" @click="editCalc(row, 'data_disk_limit')"></t-icon>
                    <t-icon name="delete" @click="comDel('data_disk_limit',row)"></t-icon>
                  </div>
                </template>
              </t-table>
            </div>
          </div>
        </t-tab-panel>
        <!-- 配置限制 -->
        <t-tab-panel value="limit" :label="lang.mf_limit">
          <div class="box limit-table limit-box">
            <p class="limit-tip">
              <img :src="`/plugins/server/mf_cloud/template/admin/img/warning.svg`" alt="">
              {{lang.mf_tip19}}
            </p>
            <div class="limit-item" v-for="(item,index) in limitArr" :key="index">
              <div class="com-top">
                <p class="tit">
                  {{item.tit}}
                </p>
                <div class="add-btn" @click="addLimit(item.name)">{{lang.order_text53}}{{lang.limit}}</div>
              </div>
              <t-table row-key="id" :data="calcLimitData(item.name)" size="medium" :columns="calcLimitCol(item.name)"
                :hover="hover" :loading="calcLoading(item.name)" :table-layout="tableLayout ? 'auto' : 'fixed'"
                display-type="fixed-width" :hide-sort-tips="true">
                <template slot="sortIcon">
                  <t-icon name="caret-down-small"></t-icon>
                </template>
                <template #fir="{row}">
                  <template v-if="item.name === 'data_center'">
                    {{row.data_center}}
                  </template>
                  <template v-else-if="item.name === 'image'">
                    {{row.image_name}}
                  </template>
                  <template v-else>
                    {{row.min_bw}}-{{row.max_bw}}
                  </template>
                </template>
                <template #cpu="{row}">
                  <template v-for="(cpu,ind) in row.cpu || []">
                    <span v-if="ind>=1">，</span>{{cpu}}{{lang.cores}}
                  </template>
                </template>
                <template #memory="{row}">
                  <template v-if="limitMemoryType === 'radio'">
                    <template v-for="(m,ind) in calcMemery(row.memory)">
                      <span v-if="ind>=1">，</span>{{m}}{{memory_unit}}
                    </template>
                  </template>
                  <template v-else>
                    {{row.min_memory}}{{memory_unit}}-{{row.max_memory}}{{memory_unit}}
                  </template>
                </template>
                <template #price="{row}">
                  <span>{{currency_prefix}}{{(row.price * 1).toFixed(2)}}</span>&nbsp;{{lang.rise}}
                </template>
                <template #op="{row}">
                  <div class="com-opt">
                    <t-icon name="edit-1" @click="editLimit(item.name, row)"></t-icon>
                    <t-icon name="delete" @click="comDel(item.name,row)"></t-icon>
                  </div>
                </template>
              </t-table>
            </div>
          </div>
        </t-tab-panel>
        <!-- 操作系统 -->
        <t-tab-panel value="system" :label="lang.opt_system">
          <div class="box">
            <div class="top-opt">
              <div class="item">
                <t-select v-model="systemParams.image_group_id" class="select"
                  :placeholder="`${lang.select}${lang.system_classify}`" clearable>
                  <t-option :key="item.id" :value="item.id" :label="item.name" v-for="item in systemGroup">
                  </t-option>
                </t-select>
                <t-input v-model="systemParams.keywords" class="ml_10" clearable
                  :placeholder="`${lang.input}${lang.system_name}`"></t-input>
                <t-button class="ml_10" @click="getSystemList">{{lang.search}}</t-button>
              </div>
              <div class="item">
                <t-button @click="classManage">{{lang.news_classific}}{{lang.manage}}</t-button>
                <t-button @click="refeshImageHandler" theme="default" class="ml_10">{{lang.get_system}}</t-button>
                <div class="add-system ml_10" @click="createNewSys">{{lang.add}}{{lang.system}}</div>
              </div>
            </div>
            <t-table row-key="id" :data="systemList" size="medium" :columns="systemColumns" :hover="hover"
              :loading="loading" table-layout="auto" display-type="fixed-width" :hide-sort-tips="true">
              <template slot="sortIcon">
                <t-icon name="caret-down-small"></t-icon>
              </template>
              <template #image_group_name="{row}">
                <span class="class-name">
                  <img :src="`/plugins/server/mf_cloud/template/admin/img/${row.icon}.svg`" alt="" class="icon">
                  {{row.image_group_name}}
                </span>
              </template>
              <template #charge="{row}">
                <t-switch size="small" :custom-value="[1,0]" v-model="row.charge" @change="changeSystemStatus(row)">
                </t-switch>
              </template>
              <template #price="{row}">
                {{currency_prefix}}&nbsp;{{row.price}}
              </template>
              <template #enable="{row}">
                <t-switch size="small" :custom-value="[1,0]" v-model="row.enable" @change="changeSystemStatus(row)">
                </t-switch>
              </template>
              <template #op="{row}">
                <div class="com-opt">
                  <t-icon name="edit-1" @click="editSystem(row)"></t-icon>
                  <t-icon name="delete" @click="comDel('system',row)"></t-icon>
                </div>
              </template>
            </t-table>
          </div>
        </t-tab-panel>
        <!-- 套餐配置 -->
        <t-tab-panel value="recommend" :label="lang.package_config">
          <div class="box">
            <div class="com-top">
              <p class="tit">
                {{lang.package_config}}
              </p>
              <div class="right">
                <div class="add-btn" @click="handlerRange">{{lang.upgrade_range}}</div>
                <div class="add-btn" @click="addRecommend">{{lang.order_text53}}</div>
              </div>
            </div>
            <t-table row-key="id" :data="recommendList" size="medium" :columns="recommendColumns" :hover="hover"
              :loading="dataLoading" :table-layout="tableLayout ? 'auto' : 'fixed'" display-type="fixed-width"
              :hide-sort-tips="true">
              <template slot="sortIcon">
                <t-icon name="caret-down-small"></t-icon>
              </template>
              <template #value="{row}">
                <template v-if="row.type === 'radio'">
                  {{row.value}}
                </template>
                <template v-else>
                  {{row.min_value}}-{{row.max_value}}
                </template>
              </template>
              <template #price="{row}">
                <span>{{currency_prefix}}{{(row.price*1).toFixed(2)}}</span>
                <template v-if="row.duration">/{{row.duration}}</template>
                &nbsp;{{lang.rise}}
              </template>
              <template #hidden="{row}">
                <t-switch size="medium" :custom-value="[0,1]" v-model="row.hidden" @change="onChange(row)"></t-switch>
              </template>
              <template #op="{row}">
                <div class="com-opt">
                  <t-tooltip :content="lang.edit" :show-arrow="false" theme="light">
                    <t-icon name="edit-1" @click="editRecommend(row)"></t-icon>
                  </t-tooltip>
                  <t-tooltip :content="lang.delete" :show-arrow="false" theme="light">
                    <t-icon name="delete" @click="comDel('recommend',row)"></t-icon>
                  </t-tooltip>
                </div>
              </template>
            </t-table>
            <div class="bot-tip">
              <p>
                {{lang.mf_package_tip8}}
                <t-switch :custom-value="[1,0]" v-model="otherForm.no_upgrade_tip_show" size="small"
                  @change="changeUpgradeTip"></t-switch>
              </p>
              <p>
                {{lang.mf_only_package}}
                <t-switch :custom-value="[1,0]" v-model="otherForm.only_sale_recommend_config" size="small"
                  @change="changeOnlyPackage"></t-switch>
                <span class="s-tip">{{lang.mf_package_tip1}}</span>
              </p>
              <p class="s-tip">{{lang.mf_package_tip2}}</p>
            </div>
          </div>
        </t-tab-panel>
        <!-- 其他设置 -->
        <t-tab-panel value="other" :label="lang.other_setting">
          <div class="box other-box">
            <t-form :data="otherForm" ref="otherConfig" @submit="submitConfig" :rules="dataRules" class="other-form">
              <!-- 选择版本 -->
              <t-form-item :label="`${lang.confirm}${lang.version}`" label-align="top">
                <t-select v-model="otherForm.type">
                  <t-option :value="item.value" :label="item.label" v-for="(item,index) in versionArr"
                    :key="index"></t-option>
                </t-select>
              </t-form-item>
              <t-form-item :label="lang.mf_tip5" label-align="top" v-if="otherForm.type !== 'hyperv'">
                <t-input v-model="otherForm.ipv6_num" :placeholder="lang.mf_tip5"></t-input>
              </t-form-item>
              <template v-if="otherForm.type !== 'hyperv'">
                <t-form-item :label="`NAT${lang.forward}`" label-align="top">
                  <t-input v-model="otherForm.nat_acl_limit" :placeholder="`NAT${lang.forward}`"></t-input>
                </t-form-item>
                <t-form-item label="">
                  <t-checkbox v-model="otherForm.default_nat_acl">{{lang.default_nat_acl}}</t-checkbox>
                  <span class="s-tip">{{lang.default_nat_acl_tip}}</span>
                </t-form-item>
                <t-form-item :label="lang.nat_web" label-align="top">
                  <t-input v-model="otherForm.nat_web_limit" :placeholder="lang.nat_web"></t-input>
                </t-form-item>
                <t-form-item label="">
                  <t-checkbox v-model="otherForm.default_nat_web">{{lang.default_nat_web}}</t-checkbox>
                  <span class="s-tip">{{lang.default_nat_web_tip}}</span>
                </t-form-item>
                <t-form-item :label="lang.niccard" label-align="top">
                  <t-select v-model="otherForm.niccard">
                    <t-option :value="0" :label="lang.default" :key="0"></t-option>
                    <t-option :value="1" label="Realtek 8139" :key="1"></t-option>
                    <t-option :value="2" label="Intel PRO/1000" :key="2"></t-option>
                    <t-option :value="3" label="Virtio" :key="3"></t-option>
                  </t-select>
                </t-form-item>
                <t-form-item :label="lang.cpu_model" label-align="top">
                  <t-select v-model="otherForm.cpu_model">
                    <t-option :value="0" :label="lang.default" :key="0"></t-option>
                    <t-option :value="1" label="host-passthrough" :key="1"></t-option>
                    <t-option :value="2" label="host-model" :key="2"></t-option>
                    <t-option :value="3" label="custom" :key="3"></t-option>
                  </t-select>
                </t-form-item>
                <t-form-item :label="lang.enable_rules" label-align="top" style="width:250px;">
                  <t-select v-model="otherForm.node_priority">
                    <t-option v-for="item in rulesList" :value="item.value" :label="item.label"
                      :key="item.value"></t-option>
                  </t-select>
                </t-form-item>
                <t-form-item :label="lang.virtualization">
                  <t-switch :custom-value="[1,0]" v-model="otherForm.ip_mac_bind" size="small">
                  </t-switch>
                  <t-tooltip :content="lang.mf_tip34" :show-arrow="false" theme="light" placement="top-left">
                    <t-icon name="help-circle"></t-icon>
                  </t-tooltip>
                </t-form-item>
                <t-form-item :label="lang.allow_ssh">
                  <t-switch :custom-value="[1,0]" v-model="otherForm.support_ssh_key" size="small">
                  </t-switch>
                  <t-tooltip :content="lang.ssh_tip" :show-arrow="false" theme="light" placement="top-left">
                    <t-icon name="help-circle"></t-icon>
                  </t-tooltip>
                </t-form-item>
              </template>
              <t-form-item :label="lang.random_ssh">
                <t-switch :custom-value="[1,0]" v-model="otherForm.rand_ssh_port" size="small">
                </t-switch>
              </t-form-item>
              <t-form-item :label="lang.is_need_code1">
                <t-switch :custom-value="[1,0]" v-model="otherForm.reset_password_sms_verify" size="small">
                </t-switch>
              </t-form-item>
              <t-form-item :label="lang.is_need_code2">
                <t-switch :custom-value="[1,0]" v-model="otherForm.reinstall_sms_verify" size="small">
                </t-switch>
              </t-form-item>
              <t-form-item :label="lang.net_type" v-if="otherForm.type === 'host'">
                <div class="net_type">
                  <div class="check">
                    <t-checkbox v-model="otherForm.support_normal_network">{{lang.normal_network}}</t-checkbox>
                  </div>
                  <div class="check">
                    <t-checkbox v-model="otherForm.support_vpc_network">{{lang.vpc_network}}</t-checkbox>
                    <div v-if="otherForm.support_vpc_network" class="public_ip">
                      <t-switch :custom-value="[1,0]" v-model="otherForm.support_public_ip" size="small" disabled>
                      </t-switch>
                      {{lang.support_public_ip}}
                    </div>
                  </div>
                </div>
              </t-form-item>
              <!-- 备份管理 -->
              <t-form-item :label="lang.backup_manage">
                <t-switch :custom-value="[1,0]" v-model="otherForm.backup_enable" size="small">
                </t-switch>
                <t-tooltip :content="lang.backup_tip" :show-arrow="false" theme="light" placement="top-left">
                  <t-icon name="help-circle"></t-icon>
                </t-tooltip>
              </t-form-item>
              <t-table row-key="id" :data="backList" size="medium" :columns="backupColumns" :hover="hover"
                :loading="backLoading" :table-layout="tableLayout ? 'auto' : 'fixed'" display-type="fixed-width"
                :hide-sort-tips="true" class="back-table" bordered :loading="backLoading"
                v-show="otherForm.backup_enable" style="margin-bottom: 40px;">
                <template #num="{row}">
                  <t-input-number v-model="row.num" theme="column" :min="1" :max="999" style="width: 88px" auto
                    :disabled="!row.status">
                  </t-input-number>
                </template>
                <template #id="{row,rowIndex}">
                  {{rowIndex + 1}}
                </template>
                <template #price="{row,rowIndex}">
                  <t-input-number v-model="row.price" theme="column" :min="0" :step="1.00" :decimal-places="2"
                    :disabled="!row.status" :label="currency_prefix" style="width: 120px;">
                  </t-input-number>
                  <template v-if="row.status">
                    <!-- <div class="com-icon" @click="saveBack(row,'backup')">
                      <t-icon name="check"></t-icon>
                    </div> -->
                    <div class="com-icon" @click="closeEdit(row,rowIndex, 'backup')"
                      v-if="!(rowIndex === 0 && !row.id)">
                      <t-icon name="close"></t-icon>
                    </div>
                  </template>
                  <template v-else>
                    <div class="com-icon" @click="openEdit('backup',rowIndex)">
                      <t-icon name="edit"></t-icon>
                    </div>
                    <!--  v-if="rowIndex !== 0" -->
                    <div class="com-icon" @click="deleteBackup('backup',rowIndex)" v-if="rowIndex !== 0">
                      <t-icon name="remove"></t-icon>
                    </div>
                  </template>
                  <div class="com-icon" v-if="rowIndex === backList.length-1 && backList.length < 5"
                    @click="addGroup('backup')">
                    <t-icon name="add"></t-icon>
                  </div>
                </template>
                <template #available="{row}">
                  <t-switch :custom-value="[1,0]" v-model="row.enable" @click.native="changeSwitch(row)">
                  </t-switch>
                </template>
              </t-table>
              <!-- 快照管理管理 -->
              <template v-if="otherForm.type !== 'hyperv'">
                <t-form-item :label="lang.snap_manage">
                  <t-switch :custom-value="[1,0]" v-model="otherForm.snap_enable" size="small">
                  </t-switch>
                  <t-tooltip :content="lang.snap_tip" :show-arrow="false" theme="light" placement="top-left">
                    <t-icon name="help-circle"></t-icon>
                  </t-tooltip>
                </t-form-item>
                <t-table row-key="id" :data="snapList" size="medium" :columns="backupColumns" :hover="hover"
                  :loading="snapLoading" :table-layout="tableLayout ? 'auto' : 'fixed'" display-type="fixed-width"
                  :hide-sort-tips="true" class="back-table" bordered v-show="otherForm.snap_enable"
                  style="margin-bottom: 40px;">
                  <template #num="{row}">
                    <t-input-number v-model="row.num" theme="column" :min="1" :max="999" style="width: 88px"
                      :disabled="!row.status">
                    </t-input-number>
                  </template>
                  <template #id="{row,rowIndex}">
                    {{rowIndex + 1}}
                  </template>
                  <template #price="{row,rowIndex}">
                    <t-input-number v-model="row.price" theme="column" :min="0" :step="1.00" :decimal-places="2"
                      style="width: 120px;" :disabled="!row.status" :label="currency_prefix">
                    </t-input-number>
                    <template v-if="row.status">
                      <!-- <div class="com-icon" @click="saveBack(row,'snap')">
                      <t-icon name="check"></t-icon>
                    </div> -->
                      <!-- v-if="!(rowIndex === 0 && !row.id)" -->
                      <div class="com-icon" @click="closeEdit(row,rowIndex, 'snap')"
                        v-if="!(rowIndex === 0 && !row.id)">
                        <t-icon name="close"></t-icon>
                      </div>
                    </template>
                    <template v-else>
                      <div class="com-icon" @click="openEdit('snap',rowIndex)">
                        <t-icon name="edit"></t-icon>
                      </div>
                      <div class="com-icon" @click="deleteBackup('snap',rowIndex)" v-if="rowIndex !== 0">
                        <t-icon name="remove"></t-icon>
                      </div>
                    </template>
                    <div class="com-icon" v-if="rowIndex === snapList.length-1 && snapList.length < 5"
                      @click="addGroup('snap')">
                      <t-icon name="add"></t-icon>
                    </div>
                  </template>
                  <template #available="{row}">
                    <t-switch :custom-value="[1,0]" v-model="row.enable" @click.native="changeSwitch(row)">
                    </t-switch>
                  </template>
                </t-table>
              </template>

              <!-- 资源包 -->
              <template v-if="otherForm.is_agent">
                <t-form-item :label="lang.agent_docking">
                </t-form-item>
                <div class="resource-add" v-if="resourceList.length === 0 " @click="addResourece">
                  <t-icon name="add"></t-icon>
                </div>
                <t-table row-key="id" :data="resourceList" size="medium" :columns="resourceColumns" :hover="hover"
                  :loading="snapLoading" :table-layout="tableLayout ? 'auto' : 'fixed'" display-type="fixed-width"
                  :hide-sort-tips="true" class="back-table" bordered style="margin-bottom: 40px;" v-else>
                  <template #rid="{row}">
                    <t-input v-model="row.rid" :disabled="!row.status">
                    </t-input>
                  </template>
                  <template #id="{row,rowIndex}">
                    {{rowIndex + 1}}
                  </template>
                  <template #name="{row,rowIndex}">
                    <t-input v-model="row.name" :disabled="!row.status">
                    </t-input>
                    <template v-if="row.status">
                      <div class="com-icon" @click="closeEdit(row,rowIndex, 'resource')">
                        <t-icon name="close"></t-icon>
                      </div>
                    </template>
                    <template v-else>
                      <div class="com-icon" @click="openEdit('resource',rowIndex)">
                        <t-icon name="edit"></t-icon>
                      </div>
                      <div class="com-icon" @click="deleteBackup('resource',rowIndex)">
                        <t-icon name="remove"></t-icon>
                      </div>
                    </template>
                    <div class="com-icon" @click="addGroup('resource')"
                      v-if="rowIndex === resourceList.length-1 || resourceList.length === 1 ">
                      <t-icon name="add"></t-icon>
                    </div>
                  </template>
                  <template #available="{row}">
                    <t-switch :custom-value="[1,0]" v-model="row.enable" @click.native="changeSwitch(row)">
                    </t-switch>
                  </template>
                </t-table>
              </template>

              <t-popconfirm :visible="showConfirm" theme="default" :content="deleteTip">
                <t-button theme="primary" type="submit" :loading="submitLoading" class="submit"
                  :style="{'margin-top': otherForm.snap_enable ?  '0' : '5px'}">{{lang.hold}}
                </t-button>
                <t-button slot="confirmBtn" size="small" theme="primary" @click="handlerConfig">{{lang.sure}}</t-button>
                <t-button slot="cancelBtn" size="small" variant="text" style="margin-left: 12px"
                  @click="showConfirm = false">{{lang.cancel}}</t-button>
              </t-popconfirm>
            </t-form>
          </div>
        </t-tab-panel>
      </t-tabs>
    </div>
    <!-- 新增/修改 周期 -->
    <t-dialog :header="comTitle" :visible.sync="cycleModel" :footer="false" width="600" @close="closeData"
      :close-on-overlay-click="false">
      <t-form :data="cycleForm" ref="cycleForm" @submit="submitCycle" :rules="cycleRules" class="cycle-form"
        v-if="cycleModel">
        <t-form-item :label="lang.cycle_name" name="name">
          <t-input v-model="cycleForm.name" :placeholder="lang.input+lang.cycle_name"></t-input>
        </t-form-item>
        <t-form-item :label="lang.cycle_time" class="required">
          <t-form-item class="cycle_time" name="num" style="margin-bottom: 0;" :required-mark="false">
            <t-input v-model="cycleForm.num" :placeholder="lang.input+lang.cycle_time"></t-input>
          </t-form-item>
          <t-form-item :required-mark="false">
            <t-select v-model="cycleForm.unit">
              <t-option :key="item.value" :value="item.value" :label="item.label" v-for="item in cycleTime">
              </t-option>
            </t-select>
          </t-form-item>
        </t-form-item>
        <t-form-item :label="lang.price_factor" name="price_factor">
          <t-input-number v-model="cycleForm.price_factor" :placeholder="lang.input+lang.factor" theme="normal"
            :decimal-places="2" :min="0" :max="9999">
          </t-input-number>
        </t-form-item>
        <t-form-item label=" " class="empty-item">
          <span>{{lang.mf_tip39}}</span>
        </t-form-item>
        <t-form-item :label="lang.cycle_price">
          <t-input-number v-model="cycleForm.price" :placeholder="lang.input+lang.price" theme="normal"
            :decimal-places="2" :min="0">
          </t-input-number>
        </t-form-item>
        <div class="com-f-btn">
          <t-button theme="primary" type="submit" :loading="submitLoading">{{lang.hold}}
          </t-button>
          <t-button theme="default" variant="base" @click="cycleModel=false">{{lang.cancel}}</t-button>
        </div>
      </t-form>
    </t-dialog>
    <!-- 周期比例 -->
    <t-dialog :header="lang.cycle_ratio" :visible.sync="ratioModel" :footer="false" width="600"
      :close-on-overlay-click="false">
      <t-table row-key="id" :data="ratioData" size="medium" :columns="ratioColumns" :hover="hover" :loading="loading"
        :table-layout="tableLayout ? 'auto' : 'fixed'" display-type="fixed-width" :hide-sort-tips="true">
        <template #unit="{row}">
          <span>{{row.num}}{{lang[row.unit]}}</span>
        </template>
        <template #ratio="{row}">
          <t-input-number v-model="row.ratio" :placeholder="lang.input+lang.mf_ratio" theme="normal" :decimal-places="2"
            :min="0.01">
          </t-input-number>
        </template>
      </t-table>
      <div class="ratio-tip">
        <p>*{{lang.mf_notes}}</p>
        <p>{{lang.mf_ratio_tip1}}</p>
        <p>{{lang.mf_ratio_tip2}}</p>
        <p>{{lang.mf_ratio_tip3}}</p>
        <p>{{lang.mf_ratio_tip4}}</p>
      </div>
      <div class="com-f-btn">
        <t-button theme="primary" @click="saveRatio" :loading="submitLoading">{{lang.hold}}
        </t-button>
        <t-button theme="default" variant="base" @click="ratioModel=false">{{lang.cancel}}</t-button>
      </div>
    </t-dialog>
    <!-- 新增/编辑系统 -->
    <t-dialog :header="comTitle" :visible.sync="systemModel" :footer="false" width="600" @close="closeData"
      :close-on-overlay-click="false">
      <t-form :data="createSystem" ref="cycleForm" @submit="submitSystem" :rules="cycleRules" class="system-form"
        v-if="systemModel">
        <t-form-item :label="lang.system_classify" name="image_group_id">
          <t-select v-model="createSystem.image_group_id" class="select"
            :placeholder="`${lang.select}${lang.system_classify}`" clearable>
            <t-option :key="item.id" :value="item.id" :label="item.name" v-for="item in systemGroup">
            </t-option>
          </t-select>
        </t-form-item>
        <t-form-item :label="lang.system_name" name="name" :rules="[
          { required: true, message: lang.input + lang.system_name, type: 'error' },
          ]">
          <t-input v-model="createSystem.name" :placeholder="lang.input+lang.system_name"></t-input>
        </t-form-item>
        <t-form-item :label="lang.opt_system + 'ID'" name="rel_image_id">
          <t-input v-model="createSystem.rel_image_id" :placeholder="lang.input+lang.opt_system + 'ID'"></t-input>
        </t-form-item>
        <t-form-item :label="lang.mf_charge">
          <t-switch size="small" :custom-value="[1,0]" v-model="createSystem.charge">
          </t-switch>
        </t-form-item>
        <t-form-item :label="lang.price" v-if="createSystem.charge" name="price">
          <t-input v-model="createSystem.price" :placeholder="lang.input+lang.price"></t-input>
        </t-form-item>
        <t-form-item :label="lang.mf_enable">
          <t-switch size="small" :custom-value="[1,0]" v-model="createSystem.enable">
          </t-switch>
        </t-form-item>
        <div class="com-f-btn">
          <t-button theme="primary" type="submit" :loading="submitLoading">{{lang.hold}}
          </t-button>
          <t-button theme="default" variant="base" @click="systemModel=false">{{lang.cancel}}</t-button>
        </div>
      </t-form>
    </t-dialog>
    <!-- 新增/编辑分类管理-->
    <t-dialog :header="`${lang.classific_manage}`" :visible.sync="classModel" :footer="false" width="600"
      @close="closeData" :close-on-overlay-click="false" class="class-dialog">
      <t-form :data="classParams" ref="classForm" @submit="submitSystemGroup" :rules="cycleRules" v-if="classModel">
        <t-form-item :label="lang.system_name" name="name" :rules="[
          { required: true, message: lang.input + lang.system_name, type: 'error', trigger: 'blur' }]">
          <t-input v-model="classParams.name" placeholder=" "></t-input>
        </t-form-item>
        <t-form-item :label="lang.mf_icon" name="icon">
          <t-select v-model="classParams.icon" :popup-props="popupProps" class="custom-select"
            :placeholder="`${lang.select}${lang.mf_icon}`" clearable>
            <img class="s-icon" :class="{noIcon: !classParams.icon}" slot="prefixIcon" style="margin-right: 8px"
              :src="`/plugins/server/mf_cloud/template/admin/img/${classParams.icon}.svg`" />
            <t-option :key="index" :value="item.value" :label="item.label" v-for="(item,index) in iconSelecet"
              class="custom-icon">
              <img :src="item.label" alt="" class="icon">
            </t-option>
          </t-select>
          <t-button theme="primary" type="submit" :loading="submitLoading" style="margin-left: 14px;">{{lang.hold}}
          </t-button>
        </t-form-item>
      </t-form>
      <!-- 分类表格 -->
      <t-table row-key="id" :data="systemGroup" size="medium" :columns="groupColumns" :hover="hover" :loading="loading"
        table-layout="auto" display-type="fixed-width" :hide-sort-tips="true" max-height="450px"
        style="margin-top: 30px;" drag-sort="row-handler" @drag-sort="changeSort">
        <template slot="sortIcon">
          <t-icon name="caret-down-small"></t-icon>
        </template>
        <template #drag="{row}">
          <t-icon name="move"></t-icon>
        </template>
        <template #image_group_name="{row}">
          <span class="class-name">
            <img :src="`/plugins/server/mf_cloud/template/admin/img/${row.icon}.svg`" alt="" class="icon">
            {{row.name}}
          </span>
        </template>
        <template #op="{row}">
          <div class="com-opt">
            <t-icon name="edit-1" @click="editGroup(row)"></t-icon>
            <t-icon name="delete" @click="comDel('group',row)"></t-icon>
          </div>
        </template>
      </t-table>
    </t-dialog>
    <!-- 新增/修改 cpu / memory , system, data -->
    <t-dialog :header="comTitle" :visible.sync="calcModel" :footer="false" width="600" @close="closeData"
      :close-on-overlay-click="false" class="cpuDialog">
      <t-form :data="calcForm" ref="cycleForm" @submit="submitCalc" :rules="calcRules" class="cycle-form"
        v-if="calcModel">
        <t-form-item :label="lang.mf_cores" name="cpuValue" v-if="calcType === 'cpu'">
          <t-input v-model="calcForm.cpuValue" :placeholder="lang.input+lang.mf_cores"></t-input>
        </t-form-item>
        <!-- 配置方式 -->
        <t-form-item :label="`${lang.config}${lang.mf_way}`" name="type" v-if="calcType !== 'cpu'" class="mem-congfig">
          <t-form-item>
            <t-select v-model="calcForm.type" :placeholder="`${lang.select}${lang.config}${lang.mf_way}`"
              :disabled="disabledWay">
              <t-option :key="item.value" :value="item.value" :label="item.label" v-for="item in configType">
              </t-option>
            </t-select>
          </t-form-item>
          <t-form-item>
            <div class="config-tip">
              <span class="notes">{{lang.mf_notes}}</span>
              <p class="notes-txt">
                {{lang.mf_tip6}}<br>
                {{lang.mf_tip7}}<br>
                {{lang.mf_tip8}}<br>
              </p>
            </div>
          </t-form-item>
        </t-form-item>
        <!-- 内存单位 -->
        <t-form-item :label="lang.memory_unit" v-if="calcType === 'memory'">
          <t-radio-group v-model="calcForm.memory_unit" :disabled="memoryList.length > 0">
            <t-radio value="GB">GB</t-radio>
            <t-radio value="MB">MB</t-radio>
          </t-radio-group>
        </t-form-item>
        <!-- 内存/系统盘/数据盘 -->
        <t-form-item :label="calcName(calcType) + '(' + calcUnit +')'" v-if="calcType !== 'cpu'">
          <t-form-item v-if="calcForm.type === 'radio'" name="value" :required-mark="false" style="width: 100%;" :rules="[
        { required: true, message: `${lang.input}` + calcName(calcType), type: 'error' },
        {
          pattern: /^([1-9][0-9]*)$/, message: lang.input + lang.verify16, type: 'warning'
        },
        {
          validator: val => calcRange(val),
           message: calcType === 'memory' ? (calcForm.memory_unit === 'GB' ? `${lang.input}1-512${lang.verify18}` :
           `${lang.input}128-524288${lang.verify18}`)
           :`${lang.input}1-1048576${lang.verify18}`  , type: 'warning'
        }
        ]">
            <t-input v-model="calcForm.value" :placeholder="lang.input+calcName(calcType)"></t-input>
          </t-form-item>
          <t-form-item v-else class="mul-select">
            <t-form-item label=" " name="min_value" :required-mark="false" :rules="[
          { required: true, message: `${lang.input}` + calcName(calcType), type: 'error' },
          {
            pattern: /^([1-9][0-9]*)$/, message: lang.input + lang.verify16, type: 'warning'
          },
          {
            validator: val => calcRange(val),
             message: calcType === 'memory' ? (calcForm.memory_unit === 'GB' ? `${lang.input}1-512${lang.verify18}` : `${lang.input}128-524288${lang.verify1}`)
             :`${lang.input}1-1048576${lang.verify18}`  , type: 'warning'
          }
          ]">
              <t-input v-model="calcForm.min_value" :placeholder="lang.min_value"
                @blur="changeMin($event, 'calcForm')"></t-input>
            </t-form-item>
            <t-form-item label=" " name="max_value" :required-mark="false" :rules="[
          { required: true, message: `${lang.input}` + calcName(calcType), type: 'error' },
          {
            pattern: /^([1-9][0-9]*)$/, message: lang.input + lang.verify16, type: 'warning'
          },
          {
            validator: val => calcRange(val),
             message: calcType === 'memory' ? (calcForm.memory_unit === 'GB' ? `${lang.input}1-512${lang.verify18}`
             : `${lang.input}128-524288${lang.verify1}`)
             :`${lang.input}1-1048576${lang.verify18}`  , type: 'warning'
          }
          ]">
              <t-input v-model="calcForm.max_value" :placeholder="lang.max_value"
                @blur="changeMax($event, 'calcForm')"></t-input>
            </t-form-item>
          </t-form-item>
        </t-form-item>
        <!-- 周期价格 -->
        <t-form-item :label="lang.price_config">
          <div class="price-box">
            <div class="item" v-for="(item,index) in calcForm.price" :key="item.id">
              <p class="txt">{{item.name}}</p>
              <p class="num">
                <!-- 循环验证 -->
                <t-form-item :name="`price[${index}].price`"
                  :ruels="[ item.price * 1 ? calcRules.price : {required: true} ]">
                  <t-input v-model="item.price"
                    :placeholder="(calcForm.type === 'step' || calcForm.type === 'total') ? calcPlaceh: lang.input+lang.money"
                    @blur="blurPrice($event,index)"></t-input>
                </t-form-item>
              </p>
            </div>
            <!-- 自动填充 -->
            <div class="item">
              <p class="txt"></p>
              <p class="num"><t-button size="small" :disabled="isShowFill(calcForm.price)"
                  @click="autoFill('calcForm',calcForm.price)">{{lang.autofill}}</t-button>
              </p>
            </div>
          </div>
        </t-form-item>
        <p class="advance_config" v-if="calcType !== 'memory'" @click="changeAdvance">
          {{lang.advance_config}}
          <template>
            <t-icon :name="isAdvance ? 'chevron-up' : 'chevron-down'"></t-icon>
          </template>
        </p>
        <!-- 高级设置 -->
        <div class="advance_box" v-show="isAdvance">
          <template v-if="calcType === 'cpu'">
            <t-form-item :label="lang.mf_tip3" label-align="top" v-if="otherForm.type !== 'hyperv'">
              <t-input v-model="calcForm.other_config.advanced_cpu" :placeholder="lang.input"></t-input>
            </t-form-item>
            <t-form-item :label="lang.mf_tip4" label-align="top">
              <t-input v-model="calcForm.other_config.cpu_limit" :placeholder="lang.input"></t-input>
            </t-form-item>
            <!-- <t-form-item :label="lang.mf_tip5" label-align="top">
            <t-input v-model="calcForm.other_config.ipv6_num" :placeholder="lang.input"></t-input>
          </t-form-item> -->
          </template>
          <template v-if="calcType === 'system_disk' || calcType === 'data_disk'">
            <t-form-item :label="lang.disk_type" label-align="top">
              <t-input v-model="calcForm.other_config.disk_type" :placeholder="lang.input"></t-input>
            </t-form-item>
            <t-form-item :label="lang.store_id" label-align="top">
              <t-input v-model="calcForm.other_config.store_id" :placeholder="lang.input"></t-input>
            </t-form-item>
          </template>
        </div>
        <div class="com-f-btn">
          <t-button theme="primary" type="submit" :loading="submitLoading">{{lang.hold}}
          </t-button>
          <t-button theme="default" variant="base" @click="calcModel=false">{{lang.cancel}}</t-button>
        </div>
      </t-form>
    </t-dialog>
    <!-- 新增/修改 性能配置-->
    <t-dialog :header="comTitle" :visible.sync="natureModel" :footer="false" width="600" @close="closeData"
      :close-on-overlay-click="false" class="natureModel">
      <t-form :data="calcForm" ref="calcForm" @submit="submitNature" :rules="calcRules" class="cycle-form"
        v-if="natureModel">
        <t-form-item :label="lang.capacity_size" class="required">
          <t-form-item label=" " name="min_value" :required-mark="false" class="cycle_time">
            <t-input v-model="calcForm.min_value" :placeholder="lang.input+lang.min_value"
              @blur="changeMin($event, 'calcForm')"></t-input>
          </t-form-item>
          <t-form-item label=" " name="max_value" :required-mark="false" class="cycle_time">
            <t-input v-model="calcForm.max_value" :placeholder="lang.input+lang.max_value"
              @blur="changeMax($event, 'calcForm')"></t-input>
          </t-form-item>
        </t-form-item>
        <template v-if="otherForm.type !== 'hyperv'">
          <t-form-item :label="lang.random_read" name="read_bytes">
            <t-input v-model="calcForm.read_bytes" :placeholder="lang.input"></t-input>
          </t-form-item>
          <t-form-item :label="lang.random_write" name="write_bytes">
            <t-input v-model="calcForm.write_bytes" :placeholder="lang.input"></t-input>
          </t-form-item>
        </template>
        <t-form-item :label="lang.read_iops" name="read_iops">
          <t-input v-model="calcForm.read_iops" :placeholder="lang.input"></t-input>
        </t-form-item>
        <t-form-item :label="lang.write_iops" name="write_iops">
          <t-input v-model="calcForm.write_iops" :placeholder="lang.input"></t-input>
        </t-form-item>
        <div class="com-f-btn">
          <t-button theme="primary" type="submit" :loading="submitLoading">{{lang.hold}}
          </t-button>
          <t-button theme="default" variant="base" @click="natureModel=false">{{lang.cancel}}</t-button>
        </div>
      </t-form>
    </t-dialog>
    <!-- 新增/修改数据中心弹窗 -->
    <t-dialog :header="comTitle" :visible.sync="dataModel" :footer="false" width="635" @close="closeData">
      <t-form :data="dataForm" ref="dataForm" @submit="submitData" :rules="dataRules" class="data-form"
        v-if="dataModel">
        <t-form-item :label="lang.country_area" class="required">
          <t-form-item name="country_id" class="configs" :required-mark="false">
            <t-select v-model="dataForm.country_id" class="flow-type" :placeholder="lang.select+lang.country_area"
              filterable
              :popup-props="{ overlayClassName: `custom-data`, overlayInnerStyle: (trigger) => ({ width: `${trigger.offsetWidth}px` })}">
              <img class="s-icon" :class="{'noIcon': !dataForm.country_id }" slot="prefixIcon" :src="calcIcon" />
              <t-option :key="item.id" :value="item.id" :label="calcCountryName(item)" v-for="item in countryList"
                class="custom-icon">
                <img :src="`${host}/upload/common/country/${item.iso}.png`" alt="" class="icon">
                {{calcCountryName(item)}}
              </t-option>
            </t-select>
          </t-form-item>
          <t-form-item label="" name="city" class="configs" :required-mark="false" :rules="[
        { required: true, message: lang.input + lang.city, type: 'error' }]">
            <t-input v-model="dataForm.city" :placeholder="lang.input+lang.city"></t-input>
          </t-form-item>
        </t-form-item>
        <t-form-item :label="`${lang.area}${lang.nickname}`" name="area">
          <t-input v-model="dataForm.area" :placeholder="`${lang.input}${lang.area}${lang.nickname}`"></t-input>
        </t-form-item>
        <t-form-item :label="lang.cloud_config" name="cloud_config">
          <t-form-item name="cloud_config" class="configs" style="margin-right: 10px;margin-bottom: 0;"
            :required-mark="false">
            <t-select v-model="dataForm.cloud_config" class="flow-type" @change="changeType">
              <t-option :key="item.value" :value="item.value" :label="item.lable" v-for="item in dataConfig">
              </t-option>
            </t-select>
          </t-form-item>
          <t-form-item name="cloud_config_id" class="configs" :required-mark="false"
            :rules="[{ required: true, message: lang.input + lang[dataForm.cloud_config] + 'ID', type: 'error' },]">
            <t-input v-model="dataForm.cloud_config_id" :placeholder="lang.input+lang[dataForm.cloud_config] + 'ID'"
              class="flow">
            </t-input>
          </t-form-item>
        </t-form-item>
        <t-form-item :label="lang.sort" name="order">
          <t-input-number v-model="dataForm.order" theme="normal" :max="999" :min="0" :decimal-places="0"
            :placeholder="`${lang.input}${lang.sort}ID`"></t-input-number>
        </t-form-item>
        <div class="com-f-btn">
          <t-button theme="primary" type="submit" :loading="submitLoading">{{lang.hold}}
          </t-button>
          <t-button theme="default" variant="base" @click="closeData">{{lang.cancel}}</t-button>
        </div>
      </t-form>
    </t-dialog>
    <!-- 新增/修改 线路 -->
    <t-dialog :header="lang.line" :visible.sync="lineModel" :footer="false" width="1072" @close="closeData"
      class="line-form" :close-on-overlay-click="false" placement="center">
      <t-form :data="lineForm" ref="lineForm" @submit="submitLine" :rules="dataRules" class="data-form"
        v-if="lineModel">
        <div class="top">
          <div class="sort">
            <t-form-item :label="lang.country_area" class="required" v-if="lineType === 'add'" label-width="120px">
              <t-form-item name="country_id" class="configs" :required-mark="false">
                <t-select v-model="lineForm.country_id" class="flow-type" :placeholder="lang.select+lang.country_area"
                  filterable @change="changeCountry"
                  :popup-props="{ overlayClassName: `custom-data`, overlayInnerStyle: (trigger) => ({ width: `${trigger.offsetWidth}px` })}">
                  <img class="s-icon" :class="{'noIcon': !dataForm.country_id && !lineForm.country_id }"
                    slot="prefixIcon" :src="calcIcon1" />
                  <t-option :key="item.id" :value="item.id" :label="item.name" v-for="item in countrySelect"
                    class="custom-icon">
                    <img :src="`${host}/upload/common/country/${item.iso}.png`" alt="" class="icon">
                    {{item.name}}
                  </t-option>
                </t-select>
              </t-form-item>
              <t-form-item label="" name="city" class="configs" :required-mark="false">
                <t-select v-model="lineForm.city" class="flow-type" @change="changeCity"
                  :placeholder="lang.select+lang.city">
                  <t-option :key="c" :value="city.name" :label="city.name" v-for="(city, c) in calcCity">
                  </t-option>
                </t-select>
              </t-form-item>
              <t-form-item label="" name="data_center_id" class="configs" :required-mark="false">
                <t-select v-model="lineForm.data_center_id" class="flow-type" :placeholder="lang.select+lang.area">
                  <t-option :key="area.id" :value="area.id" :label="area.name" v-for="area in calcArea">
                  </t-option>
                </t-select>
              </t-form-item>
            </t-form-item>
          </div>
          <div class="sort">
            <t-form-item :label="lang.line_name" name="name" class="line-name" label-width="120px" :rules="[
            { required: true, message: `${lang.input}${lang.line_name}`, type: 'error' },]">
              <t-input v-model="lineForm.name" :placeholder="lang.input+lang.line_name"></t-input>
            </t-form-item>
            <t-form-item :label="lang.sort" name="order" label-width="120px">
              <t-input-number v-model="lineForm.order" theme="normal" :max="999" :min="0" :decimal-places="0"
                :placeholder="`${lang.input}${lang.sort}`"></t-input-number>
            </t-form-item>
          </div>
        </div>
        <div class="bg"></div>
        <div class="config">
          <p class="p-tit">
            {{lang.bw_price_config}}
            <t-checkbox v-model="lineForm.link_clone">{{lang.link_clone}}</t-checkbox>
          </p>
          <div class="con">
            <!-- 左侧 -->
            <div class="c-item">
              <t-form-item :label="`${lang.billing_way}`" name="bill_type" label-align="left" class="required"
                v-if="lineType === 'add'">
                <t-select v-model="lineForm.bill_type" class="bill-type" @change="lineRight=false">
                  <t-option key="bw" value="bw" :label="lang.mf_bw"></t-option>
                  <t-option key="flow" value="flow" :label="lang.mf_flow" v-if="otherForm.type !== 'hyperv'"></t-option>
                </t-select>
              </t-form-item>
              <!-- bw_data -->
              <template v-if="lineForm.bill_type === 'bw'">
                <div class="com-top">
                  <p class="tit">
                    {{lang.billing_way}}
                    <template v-if="calcSubTitle(lineForm.bw_data)">
                      {{calcSubTitle(lineForm.bw_data)}}
                    </template>
                  </p>
                  <div class="add-btn gray" @click="addLineSub('line_bw')">{{lang.order_text53}}</div>
                </div>
                <t-table row-key="id" :data="lineForm.bw_data" size="medium" :columns="bwColumns" :hover="hover"
                  :loading="loading" :table-layout="tableLayout ? 'auto' : 'fixed'" display-type="fixed-width"
                  :hide-sort-tips="true">
                  <template slot="sortIcon">
                    <t-icon name="caret-down-small"></t-icon>
                  </template>
                  <template #fir="{row}">
                    <template v-if="row.type==='radio'">
                      {{row.value}}
                    </template>
                    <template v-else>
                      {{row.min_value}}-{{row.max_value}}
                    </template>
                  </template>
                  <template #price="{row}">
                    <!-- 新增线路的时候本地处理显示 -->
                    {{currency_prefix}}
                    <template v-if="lineType === 'add'">
                      {{calcPrice(row.price)}}
                    </template>
                    <template v-else>
                      {{(row.price*1).toFixed(2)}}
                      <template v-if="row.duration">/{{row.duration}}</template>
                    </template>
                    &nbsp;{{lang.rise}}
                  </template>
                  <template #op="{row, rowIndex}">
                    <div class="com-opt">
                      <t-tooltip :content="lang.edit" :show-arrow="false" theme="light">
                        <t-icon name="edit-1" @click="editSubItem(row,rowIndex,'line_bw')"></t-icon>
                      </t-tooltip>
                      <t-tooltip :content="lang.delete" :show-arrow="false" theme="light">
                        <t-icon name="delete" @click="comDel('line_bw',row,rowIndex)"></t-icon>
                      </t-tooltip>
                    </div>
                  </template>
                </t-table>
                <p class="advance_config" @click="bw_ip_show = !bw_ip_show">
                  {{lang.advance_config}}
                  <template>
                    <t-icon :name="bw_ip_show ? 'chevron-up' : 'chevron-down'"></t-icon>
                  </template>
                </p>
                <!-- 高级设置 -->
                <div class="advance_box" v-show="bw_ip_show">
                  <t-form-item :label="`IP${lang.group}`" label-align="top">
                    <t-input v-model="lineForm.bw_ip_group" :placeholder="lang.input"></t-input>
                  </t-form-item>
                </div>
              </template>
              <!-- 流量 -->
              <template v-else>
                <div class="com-top">
                  <p class="tit">
                    {{lang.traffic_billing}}
                    <template v-if="calcSubTitle(lineForm.flow_data)"></template>
                  </p>
                  <div class="add-btn gray" @click="addLineSub('line_flow')">{{lang.order_text53}}</div>
                </div>
                <t-table row-key="id" :data="lineForm.flow_data" size="medium" :columns="calcColums('flow')"
                  :hover="hover" :loading="loading" :table-layout="tableLayout ? 'auto' : 'fixed'"
                  display-type="fixed-width" :hide-sort-tips="true">
                  <template slot="sortIcon">
                    <t-icon name="caret-down-small"></t-icon>
                  </template>
                  <template #fir="{row}">
                    {{row.value}}
                  </template>
                  <template #price="{row}">
                    <!-- 新增线路的时候本地处理显示 -->
                    {{currency_prefix}}
                    <template v-if="lineType === 'add'">
                      {{calcPrice(row.price)}}
                    </template>
                    <template v-else>
                      {{(row.price*1).toFixed(2)}}
                      <template v-if="row.duration">/{{row.duration}}</template>
                    </template>
                    &nbsp;{{lang.rise}}
                  </template>
                  <template #op="{row, rowIndex}">
                    <div class="com-opt">
                      <t-tooltip :content="lang.edit" :show-arrow="false" theme="light">
                        <t-icon name="edit-1" @click="editSubItem(row,rowIndex,'line_flow')"></t-icon>
                      </t-tooltip>
                      <t-tooltip :content="lang.delete" :show-arrow="false" theme="light">
                        <t-icon name="delete" @click="comDel('line_flow',row, rowIndex)"></t-icon>
                      </t-tooltip>
                    </div>
                  </template>
                </t-table>
                <p class="advance_config" @click="bw_ip_show = !bw_ip_show">
                  {{lang.advance_config}}
                  <template>
                    <t-icon :name="bw_ip_show ? 'chevron-up' : 'chevron-down'"></t-icon>
                  </template>
                </p>
                <!-- 高级设置 -->
                <div class="advance_box" v-show="bw_ip_show">
                  <t-form-item :label="`IP${lang.group}`" label-align="top">
                    <t-input v-model="lineForm.bw_ip_group" :placeholder="lang.input"></t-input>
                  </t-form-item>
                </div>
                <p class="s-tip">{{lang.mf_tip21}}</p>
              </template>
              <!-- 防护价格配置 -->
              <div class="com-top">
                <p class="tit">
                  <t-form-item :label="lang.protect_price_config">
                    <t-switch :custom-value="[1,0]" v-model="lineForm.defence_enable" size="small">
                    </t-switch>
                  </t-form-item>
                </p>
                <div class="add-btn gray" @click="addLineSub('line_defence')" v-show="lineForm.defence_enable">
                  {{lang.order_text53}}
                </div>
              </div>
              <t-table row-key="id" :data="lineForm.defence_data" size="medium" :columns="calcColums('defence')"
                :hover="hover" :loading="loading" :table-layout="tableLayout ? 'auto' : 'fixed'"
                display-type="fixed-width" :hide-sort-tips="true" v-show="lineForm.defence_enable">
                <template slot="sortIcon">
                  <t-icon name="caret-down-small"></t-icon>
                </template>
                <template #fir="{row}">
                  {{row.value}}
                </template>
                <template #price="{row}">
                  <!-- 新增线路的时候本地处理显示 -->
                  {{currency_prefix}}
                  <template v-if="lineType === 'add'">
                    {{calcPrice(row.price)}}
                  </template>
                  <template v-else>
                    {{(row.price*1).toFixed(2)}}
                    <template v-if="row.duration">/{{row.duration}}</template>
                  </template>
                  &nbsp;{{lang.rise}}
                </template>
                <template #op="{row,rowIndex}">
                  <div class="com-opt">
                    <t-tooltip :content="lang.edit" :show-arrow="false" theme="light">
                      <t-icon name="edit-1" @click="editSubItem(row,rowIndex,'line_defence')"></t-icon>
                    </t-tooltip>
                    <t-tooltip :content="lang.delete" :show-arrow="false" theme="light">
                      <t-icon name="delete" @click="comDel('line_defence',row,rowIndex)"></t-icon>
                    </t-tooltip>
                  </div>
                </template>
              </t-table>
              <div v-show="lineForm.defence_enable">
                <p class="advance_config" @click="defence_ip_show = !defence_ip_show">
                  {{lang.advance_config}}
                  <template>
                    <t-icon :name="defence_ip_show ? 'chevron-up' : 'chevron-down'"></t-icon>
                  </template>
                </p>
                <!-- 高级设置 -->
                <div class="advance_box" v-show="defence_ip_show">
                  <t-form-item :label="`IP${lang.group}`" label-align="top">
                    <t-input v-model="lineForm.defence_ip_group" :placeholder="lang.input"></t-input>
                  </t-form-item>
                </div>
              </div>
              <!-- 附加IP价格配置 -->
              <div class="com-top">
                <p class="tit">
                  <t-form-item :label="lang.ip_price_config">
                    <t-switch :custom-value="[1,0]" v-model="lineForm.ip_enable" size="small">
                    </t-switch>
                  </t-form-item>
                </p>
                <div class="add-btn gray" @click="addLineSub('line_ip')" v-show="lineForm.ip_enable">
                  {{lang.order_text53}}
                </div>
              </div>
              <t-table row-key="id" :data="lineForm.ip_data" size="medium" :columns="calcColums('ip')" :hover="hover"
                :loading="loading" :table-layout="tableLayout ? 'auto' : 'fixed'" display-type="fixed-width"
                :hide-sort-tips="true" v-show="lineForm.ip_enable">
                <template slot="sortIcon">
                  <t-icon name="caret-down-small"></t-icon>
                </template>
                <template #fir="{row}">
                  {{row.value}}
                </template>
                <template #price="{row}">
                  <!-- 新增线路的时候本地处理显示 -->
                  {{currency_prefix}}
                  <template v-if="lineType === 'add'">
                    {{calcPrice(row.price)}}
                  </template>
                  <template v-else>
                    {{(row.price*1).toFixed(2)}}
                    <template v-if="row.duration">/{{row.duration}}</template>
                  </template>
                  &nbsp;{{lang.rise}}
                </template>
                <template #op="{row,rowIndex}">
                  <div class="com-opt">
                    <t-tooltip :content="lang.edit" :show-arrow="false" theme="light">
                      <t-icon name="edit-1" @click="editSubItem(row,rowIndex,'line_ip')"></t-icon>
                    </t-tooltip>
                    <t-tooltip :content="lang.delete" :show-arrow="false" theme="light">
                      <t-icon name="delete" @click="comDel('line_ip',row,rowIndex)"></t-icon>
                    </t-tooltip>
                  </div>
                </template>
              </t-table>
              <!-- GPU价格配置 -->
              <div class="com-top">
                <p class="tit">
                  <t-form-item :label="lang.gpu_price_setting">
                    <t-switch :custom-value="[1,0]" v-model="lineForm.gpu_enable" size="small">
                    </t-switch>
                  </t-form-item>
                </p>
                <div class="add-btn gray" @click="addLineSub('line_gpu')" v-show="lineForm.gpu_enable">
                  {{lang.order_text53}}
                </div>
              </div>
              <t-form-item :label="`GPU${lang.box_title46}${lang.nickname}`" label-align="top"
                v-if="lineForm.gpu_enable" name="gpu_name">
                <t-input v-model="lineForm.gpu_name" :placeholder="`${lang.input}GPU${lang.box_title46}`"></t-input>
              </t-form-item>
              <t-table row-key="id" :data="lineForm.gpu_data" size="medium" :columns="calcColums('line_gpu')"
                :hover="hover" :loading="loading" :table-layout="tableLayout ? 'auto' : 'fixed'"
                display-type="fixed-width" :hide-sort-tips="true" v-show="lineForm.gpu_enable">
                <template slot="sortIcon">
                  <t-icon name="caret-down-small"></t-icon>
                </template>
                <template #fir="{row}">
                  {{row.value}}
                </template>
                <template #price="{row}">
                  <!-- 新增线路的时候本地处理显示 -->
                  {{currency_prefix}}
                  <template v-if="lineType === 'add'">
                    {{calcPrice(row.price)}}
                  </template>
                  <template v-else>
                    {{(row.price*1).toFixed(2)}}
                    <template v-if="row.duration">/{{row.duration}}</template>
                  </template>
                  &nbsp;{{lang.rise}}
                </template>
                <template #op="{row,rowIndex}">
                  <div class="com-opt">
                    <t-tooltip :content="lang.edit" :show-arrow="false" theme="light">
                      <t-icon name="edit-1" @click="editSubItem(row,rowIndex,'line_gpu')"></t-icon>
                    </t-tooltip>
                    <t-tooltip :content="lang.delete" :show-arrow="false" theme="light">
                      <t-icon name="delete" @click="comDel('line_gpu',row,rowIndex)"></t-icon>
                    </t-tooltip>
                  </div>
                </template>
              </t-table>
            </div>
            <!-- 右侧 -->
            <div class="c-item">
              <div class="empty" v-show="!lineRight">
                <p>{{lang.mf_tip12}}</p>
              </div>
              <!-- 新增、编辑线路子项 -->
              <div class="opt" v-if="lineRight">
                <t-form :data="subForm" ref="cycleForm" @submit="submitSub" :rules="calcRules" class="sub-form"
                  label-align="top">
                  <div class="scroll">
                    <!-- line_defence -->
                    <t-form-item :label="lang.defence + '（G）'" name="value" v-if="subType === 'line_defence'"
                      :rules="calcReg(lang.defence,0,999999)">
                      <t-input v-model="subForm.value" :placeholder="lang.input+lang.defence"></t-input>
                    </t-form-item>
                    <!-- line_flow -->
                    <t-form-item :label="lang.cloud_flow + '（GB）'" name="value" v-if="subType === 'line_flow'"
                      :rules="calcReg(lang.bw,0,999999)">
                      <t-input v-model="subForm.value" :placeholder="lang.input+lang.cloud_flow"></t-input>
                    </t-form-item>
                    <!-- line_ip -->
                    <t-form-item :label="`IP${lang.auth_num}（${lang.one}）`" name="value" v-if="subType === 'line_ip'"
                      :rules="calcReg(`IP${lang.auth_num}`,0,10000)">
                      <t-input v-model="subForm.value" :placeholder="`${lang.input}IP${lang.auth_num}`"></t-input>
                    </t-form-item>

                    <!-- gpu -->
                    <t-form-item :label="`GPU${lang.auth_num}`" name="value" v-if="subType === 'line_gpu'"
                      :rules="calcReg(`IP${lang.auth_num}`,0,100)">
                      <t-input v-model="subForm.value" :placeholder="`${lang.input}GPU${lang.auth_num}`"></t-input>
                    </t-form-item>
                    <!-- 配置方式 -->
                    <t-form-item :label="`${lang.billing_way}`" name="type" v-if="subType === 'line_bw'"
                      class="mem-congfig">
                      <t-select v-model="subForm.type" :placeholder="`${lang.select}${lang.billing_way}`"
                        :disabled="calcShow">
                        <t-option :key="item.value" :value="item.value" :label="item.label" v-for="item in configType">
                        </t-option>
                      </t-select>
                    </t-form-item>
                    <template v-if="subType === 'line_flow'">
                      <t-form-item class="line_flow bw-limit" :label="`${lang.bw_limit}（Mbps）`">
                        <t-form-item label="" name="other_config.out_bw" :label="lang.out" label-align="left"
                          class="limit" :rules="calcReg(lang.out_bw,0,30000)">
                          <t-input v-model="subForm.other_config.out_bw" :placeholder="lang.out_bw"></t-input>
                        </t-form-item>
                        <t-form-item label="" name="other_config.in_bw" :label="lang.in" label-align="left"
                          class="limit" :rules="calcReg(lang.out_bw,0,30000)">
                          <t-input v-model="subForm.other_config.in_bw" :placeholder="lang.in_bw"></t-input>
                        </t-form-item>
                      </t-form-item>
                    </template>
                    <!-- 内存/系统盘/数据盘 -->
                    <t-form-item :label="calcName(subType)" v-if="subType === 'line_bw'" class="required">
                      <t-form-item v-if="subForm.type === 'radio'" name="value" style="width: 100%;" class="no-lable"
                        :rules="calcReg(lang.bw,1,30000)">
                        <t-input v-model="subForm.value" :placeholder="lang.input+calcName(subType)"></t-input>
                      </t-form-item>
                      <t-form-item v-else class="mul-select">
                        <t-form-item label=" " name="min_value" :required-mark="false"
                          :rules="calcReg(lang.bw,1,30000)">
                          <t-input v-model="subForm.min_value" :placeholder="lang.min_value"
                            @blur="changeMin($event, 'subForm')"></t-input>
                        </t-form-item>
                        <t-form-item label=" " name="max_value" :required-mark="false"
                          :rules="calcReg(lang.bw,1,30000)">
                          <t-input v-model="subForm.max_value" :placeholder="lang.max_value"
                            @blur="changeMax($event, 'subForm')"></t-input>
                        </t-form-item>
                        <!-- <t-form-item label=" " name="step" :required-mark="false">
                        <t-input v-model="subForm.step" :placeholder="lang.min_step" @blur="changeStep"></t-input>
                      </t-form-item> -->
                      </t-form-item>
                    </t-form-item>
                    <!-- 周期价格 -->
                    <t-form-item :label="lang.price">
                      <div class="price-box">
                        <div class="item" v-for="(item,index) in subForm.price" :key="item.id">
                          <p class="txt">{{item.name}}</p>
                          <p class="num">
                            <!-- 循环验证 -->
                            <t-form-item :name="`price[${index}].price`"
                              :ruels="[ item.price * 1 ? calcRules.price : {required: true} ]">
                              <t-input v-model="item.price"
                                :placeholder="((subForm.type === 'step' || subForm.type === 'total') && subType === 'line_bw') ? lang.mf_tip26: lang.input+lang.money"
                                @blur="blurSubPrice($event,index)"></t-input>
                            </t-form-item>
                          </p>
                        </div>
                        <!-- 自动填充 -->
                        <div class="item">
                          <p class="txt"></p>
                          <p class="num"><t-button size="small" :disabled="isShowFill(subForm.price)"
                              @click="autoFill('subForm',subForm.price)">{{lang.autofill}}</t-button>
                          </p>
                        </div>
                      </div>
                    </t-form-item>
                    <!-- 流量 -->
                    <template v-if="subType === 'line_flow'">
                      <t-form-item :label="`${lang.traffic_type}`" class="mem-congfig" name="other_config.traffic_type">
                        <t-select v-model="subForm.other_config.traffic_type"
                          :placeholder="`${lang.select}${lang.traffic_type}`">
                          <t-option :key="item.value" :value="item.value" :label="item.label"
                            v-for="item in trafficTypes">
                          </t-option>
                        </t-select>
                      </t-form-item>
                      <t-form-item :label="`${lang.billing_cycle}`" class="mem-congfig" name="other_config.bill_cycle">
                        <template slot="label">
                          <t-tooltip :content="lang.mf_tip28 + '\n' + lang.mf_tip29" :show-arrow="false" theme="light"
                            placement="top-left">
                            <span>{{lang.billing_cycle}}</span>
                            <t-icon name="help-circle"></t-icon>
                          </t-tooltip>
                        </template>
                        <t-select v-model="subForm.other_config.bill_cycle"
                          :placeholder="`${lang.select}${lang.billing_cycle}`">
                          <t-option :key="item.value" :value="item.value" :label="item.label"
                            v-for="item in billingCycle">
                          </t-option>
                        </t-select>
                      </t-form-item>
                    </template>

                    <p class="advance_config" v-if="subType === 'line_bw' && otherForm.type !== 'hyperv'"
                      @click="changeAdvance">
                      {{lang.advance_config}}
                      <template>
                        <t-icon :name="isAdvance ? 'chevron-up' : 'chevron-down'"></t-icon>
                      </template>
                    </p>
                    <!-- 子项高级设置 -->
                    <div class="advance_box" v-show="isAdvance && otherForm.type !== 'hyperv'">
                      <template v-if="subType === 'line_bw'">
                        <t-form-item :label="lang.inflow_bw" label-align="top">
                          <t-input v-model="subForm.other_config.in_bw" :placeholder="lang.input"></t-input>
                        </t-form-item>
                        <t-form-item :label="lang.advanced_bw" label-align="top">
                          <t-input v-model="subForm.other_config.advanced_bw" :placeholder="lang.input"></t-input>
                        </t-form-item>
                      </template>
                      <!-- <template v-if="calcType === 'system_disk' || calcType === 'data_disk'">
                      <t-form-item :label="lang.disk_type" label-align="top">
                        <t-input v-model="calcForm.other_config.disk_type" :placeholder="lang.input"></t-input>
                      </t-form-item>
                    </template> -->
                    </div>
                  </div>
                  <div class="com-btn">
                    <t-button theme="primary" type="submit" :loading="submitLoading">{{lang.hold}}
                    </t-button>
                    <t-button theme="default" variant="base" @click="lineRight=false">{{lang.back}}</t-button>
                  </div>
                </t-form>
              </div>
            </div>
          </div>
          <div class="bot-opt" :class="{'hide-opt': lineRight}">
            <div class="b-item">
              <div class="com-btn">
                <t-button theme="primary" type="submit" :loading="submitLoading">{{lang.hold}}
                </t-button>
                <t-button theme="default" variant="base" @click="closeData">{{lang.cancel}}</t-button>
              </div>
            </div>
          </div>
        </div>
      </t-form>
    </t-dialog>
    <!-- 新增/修改 套餐配置 -->
    <t-dialog :header="comTitle" :visible.sync="recommendModel" :footer="false" width="1470" @close="closeData"
      class="line-form recommend-form package-dailog" :close-on-overlay-click="false" placement="center">
      <t-form :data="lineForm" ref="lineForm" @submit="submitRecommend" :rules="dataRules"
        class="data-form cpuDialog package-form" v-if="recommendModel" label-align="top">
        <div class="form-item">
          <!-- 套餐信息 -->
          <p class="com-tit">{{lang.package_info}}</p>
          <div class="short-item">
            <t-form-item :label="lang.box_label23" name="name">
              <t-input v-model="lineForm.name" :placeholder="`${lang.input}${lang.box_label23}`"></t-input>
            </t-form-item>
            <t-form-item :label="`${lang.sort}ID`" name="order">
              <t-input v-model="lineForm.order" :placeholder="`${lang.input}${lang.sort}ID`"></t-input>
            </t-form-item>
          </div>
          <t-form-item :label="lang.short_des" name="description">
            <t-input v-model="lineForm.description" :placeholder="lang.mf_tip23" :maxlength="15"></t-input>
          </t-form-item>
          <!-- 计算配置 -->
          <p class="com-tit">{{lang.mf_calc}}</p>
          <div class="three-item">
            <t-form-item :label="`CPU（${lang.cores}）`" name="cpu">
              <t-input v-model="lineForm.cpu" :placeholder="`${lang.input}CPU`"></t-input>
            </t-form-item>
            <t-form-item :label="`${lang.memory}（GB）`" name="memory" :rules="[
          { required: true, message: `${lang.input}${lang.memory}`, type: 'error' },
          {
            pattern: /^([1-9][0-9]*)$/, message: lang.input + lang.verify16, type: 'warning'
          },
          {
            validator: val =>  val >= 1 && val <= 512,
             message: `${lang.input}1-512${lang.verify18}`, type: 'warning'
          }
          ]">
              <t-input v-model="lineForm.memory" :placeholder="`${lang.input}${lang.memory}`"></t-input>
            </t-form-item>
            <t-form-item :label="`GPU${lang.auth_num}`" name="gpu_num">
              <t-input v-model="lineForm.gpu_num" :placeholder="`${lang.input}GPU${lang.auth_num}`"></t-input>
            </t-form-item>
          </div>
          <!-- 网络配置 -->
          <p class="com-tit">{{lang.network_config}}</p>
          <div class="three-item">
            <t-form-item :label="`IP${lang.auth_num}`" name="ip_num" :rules="calcReg(`IP${lang.auth_num}`,0,2000)">
              <t-input v-model="lineForm.ip_num" :placeholder="`${lang.input}IP${lang.auth_num}`"></t-input>
            </t-form-item>
            <t-form-item :label="`${lang.bw}（Mbps）`" name="bw" v-if="calcLineType==='bw'">
              <t-input v-model="lineForm.bw" :placeholder="`${lang.input}${lang.bw}`"></t-input>
            </t-form-item>
            <t-form-item :label="`${lang.cloud_flow}（GB）`" name="flow" v-if="calcLineType==='flow'">
              <t-input v-model="lineForm.flow" :placeholder="lang.mf_tip27"></t-input>
            </t-form-item>
            <t-form-item :label="`${lang.defence}（G）`" name="peak_defence"
              :rules="lineForm.peak_defence ? dataRules.peak_defence :[{}]">
              <t-input v-model="lineForm.peak_defence" :placeholder="`${lang.input}${lang.defence}`"></t-input>
            </t-form-item>
          </div>
          <div class="bot-tip">
            <p>{{lang.file_download_text16}}：</p>
            <p>{{lang.mf_package_tip3}}</p>
            <p>{{lang.mf_package_tip4}}</p>
          </div>
        </div>
        <div class="form-item">
          <p class="com-tit">{{lang.data_center}}</p>
          <t-form-item :label="lang.data_center" class="required data-item">
            <t-form-item name="country_id" :required-mark="false">
              <t-select v-model="lineForm.country_id" class="flow-type" :placeholder="lang.select+lang.country_area"
                filterable @change="changeCountry"
                :popup-props="{ overlayClassName: `custom-data`, overlayInnerStyle: (trigger) => ({ width: `${trigger.offsetWidth}px` })}">
                <img class="s-icon" :class="{'noIcon': !dataForm.country_id && !lineForm.country_id }" slot="prefixIcon"
                  :src="calcIcon1" />
                <t-option :key="item.id" :value="item.id" :label="item.name" v-for="item in countrySelect"
                  class="custom-icon">
                  <img :src="`${host}/upload/common/country/${item.iso}.png`" alt="" class="icon">
                  {{item.name}}
                </t-option>
              </t-select>
            </t-form-item>
            <t-form-item label="" name="city" :required-mark="false">
              <t-select v-model="lineForm.city" class="flow-type" @change="changeCity"
                :placeholder="lang.select+lang.city">
                <t-option :key="c" :value="city.name" :label="city.name" v-for="(city, c) in calcCity">
                </t-option>
              </t-select>
            </t-form-item>
          </t-form-item>
          <div class="short-item">
            <t-form-item :label="lang.available_area" name="data_center_id">
              <t-select v-model="lineForm.data_center_id" class="flow-type" :placeholder="lang.select+lang.area">
                <t-option :key="area.id" :value="area.id" :label="area.name" v-for="area in calcArea">
                </t-option>
              </t-select>
            </t-form-item>
            <t-form-item :label="lang.line_name" name="line_id">
              <t-select v-model="lineForm.line_id" class="flow-type" @change="changeBillType"
                :placeholder="lang.select+lang.line_name">
                <t-option :key="line.id" :value="line.id" :label="line.name" v-for="line in calcSelectLine">
                </t-option>
              </t-select>
            </t-form-item>
          </div>
          <!-- 存储配置 -->
          <p class="com-tit">{{lang.mf_store}}</p>
          <div class="short-item store-config">
            <div class="short-item">
              <t-form-item :label="`${lang.system_disk_size}（GB）`" class="data-item required">
                <t-form-item label="" name="system_disk_size" :required-mark="false">
                  <t-input v-model="lineForm.system_disk_size"
                    :placeholder="`${lang.input}${lang.system_disk_size}`"></t-input>
                </t-form-item>
                <t-form-item label="">
                  <t-input v-model="lineForm.system_disk_type"
                    :placeholder="lang.input+lang.system_disk_size + lang.type"></t-input>
                </t-form-item>
              </t-form-item>
            </div>
            <div class="short-item">
              <t-form-item :label="`${lang.data_disk}（GB）`" class="data-item">
                <t-form-item label="" name="data_disk_size"
                  :rules="lineForm.data_disk_size ? dataRules.data_disk_size :[{}]">
                  <t-input v-model="lineForm.data_disk_size" :placeholder="`${lang.input}${lang.data_disk}`"></t-input>
                </t-form-item>
                <t-form-item label="">
                  <t-input v-model="lineForm.data_disk_type"
                    :placeholder="lang.input+lang.data_disk + lang.type"></t-input>
                </t-form-item>
              </t-form-item>
            </div>
          </div>
          <p class="com-tit">{{lang.price_config}}</p>
          <t-form-item :label="lang.price">
            <div class="price-box">
              <div class="item" v-for="(item,index) in lineForm.price" :key="item.id">
                <p class="txt">{{item.name}}</p>
                <p class="num">
                  <!-- 循环验证 -->
                  <t-form-item :name="`price[${index}].price`" label-align="left"
                    :ruels="[ item.price * 1 ? dataRules.price : {required: true} ]">
                    <t-input v-model="item.price" :placeholder="lang.input+lang.money"
                      @blur="blurPackagePrice($event,index)"></t-input>
                  </t-form-item>
                </p>
              </div>
              <!-- 自动填充 -->
              <div class="item">
                <p class="txt"></p>
                <p class="num"><t-button size="small" :disabled="isShowFill(lineForm.price)"
                    @click="autoFill('lineForm',lineForm.price)">{{lang.autofill}}</t-button>
                </p>
              </div>
            </div>
          </t-form-item>
          <div class="com-f-btn">
            <t-button theme="primary" type="submit" :loading="submitLoading">{{lang.hold}}
            </t-button>
            <t-button theme="default" variant="base" @click="recommendModel = false">{{lang.cancel}}</t-button>
          </div>
        </div>
      </t-form>
    </t-dialog>
    <!-- 升降级范围 -->
    <t-dialog :header="lang.upgrade_range" :visible.sync="upgradeModel" :footer="false" width="710"
      :close-on-overlay-click="false">
      <t-table row-key="id" :data="recommendList" size="medium" :columns="upgradeColumns" :hover="hover"
        :loading="loading" :table-layout="tableLayout ? 'auto' : 'fixed'" display-type="fixed-width"
        :hide-sort-tips="true" :max-height="345">
        <template #price="{row}">
          <span>{{currency_prefix}}{{(row.price*1).toFixed(2)}}</span>
          <template v-if="row.duration">/{{row.duration}}</template>
          &nbsp;{{lang.rise}}
        </template>
        <template #range="{row, rowIndex}">
          <t-cascader v-model="row.temp" :options="calcRangeSelect(row.data_center_id, row.id)" :min-collapsed-num="1"
            :keys="{label: 'name', value: 'id'}" multiple
            @change="($event,$node) => changeRange($event, $node, rowIndex)" v-if="upgradeModel" />
        </template>
      </t-table>
      <div class="bot-tip">
        <p>*{{lang.mf_package_tip5}}</p>
        <p>*{{lang.mf_package_tip7}}</p>
        <p>*{{lang.mf_package_tip9}}</p>

      </div>
      <div class="com-f-btn" style="margin-top: 20px;">
        <t-button theme="primary" @click="saveUpgrade" :loading="submitLoading">{{lang.hold}}
        </t-button>
        <t-button theme="default" variant="base" @click="upgradeModel=false">{{lang.cancel}}</t-button>
      </div>
    </t-dialog>
    <!-- 新增/修改 配置限制 -->
    <t-dialog :header="comTitle" :visible.sync="limitModel" :footer="false" :width="isEn ? 700 : 625" @close="closeData">
      <t-form :data="lineForm" ref="lineForm" @submit="submitLimit" :rules="dataRules" class="data-form limit-form"
        v-if="limitModel">
        <t-form-item :label="lang.data_center" class="required short" v-if="limitType === 'data_center'">
          <t-form-item name="country_id" :required-mark="false">
            <t-select v-model="lineForm.country_id" class="flow-type" :placeholder="lang.select+lang.country_area"
              filterable @change="changeCountry"
              :popup-props="{ overlayClassName: `custom-data`, overlayInnerStyle: (trigger) => ({ width: `${trigger.offsetWidth}px` })}">
              <img class="s-icon" :class="{'noIcon': !dataForm.country_id && !lineForm.country_id }" slot="prefixIcon"
                :src="calcIcon1" />
              <t-option :key="item.id" :value="item.id" :label="item.name" v-for="item in countrySelect"
                class="custom-icon">
                <img :src="`${host}/upload/common/country/${item.iso}.png`" alt="" class="icon">
                {{item.name}}
              </t-option>
            </t-select>
          </t-form-item>
          <t-form-item label="" name="city" :required-mark="false">
            <t-select v-model="lineForm.city" class="flow-type" @change="changeCity"
              :placeholder="lang.select+lang.city">
              <t-option :key="c" :value="city.name" :label="city.name" v-for="(city, c) in calcCity">
              </t-option>
            </t-select>
          </t-form-item>
          <t-form-item label="" name="data_center_id" :required-mark="false">
            <t-select v-model="lineForm.data_center_id" class="flow-type" :placeholder="lang.select+lang.area">
              <t-option :key="area.id" :value="area.id" :label="area.name" v-for="area in calcArea">
              </t-option>
            </t-select>
          </t-form-item>
        </t-form-item>
        <!-- type === 'image' -->
        <t-form-item :label="lang.opt_system" class="required limit-bw" v-if="limitType === 'image'">
          <t-form-item label="" name="image_group_id" :required-mark="false">
            <t-select v-model="lineForm.image_group_id" :placeholder="lang.select+lang.system_classify">
              <t-option :key="area.id" :value="area.id" :label="area.name" v-for="area in systemGroup">
              </t-option>
            </t-select>
          </t-form-item>
          <t-form-item label="" name="image_id" :required-mark="false">
            <t-select v-model="lineForm.image_id" :placeholder="lang.select+lang.system_name">
              <t-option :key="area.id" :value="area.id" :label="area.name"
              v-for="area in calcSystem">
              </t-option>
            </t-select>
          </t-form-item>
        </t-form-item>
        <!-- cpu -->
        <t-form-item :label="`CPU（${lang.cores}）`" name="cpu"
          :rules=" [{ required: true, message: lang.select + 'CPU', type: 'error' }]">
          <t-select v-model="lineForm.cpu" :placeholder="lang.select+'CPU'" multiple :min-collapsed-num="2">
            <t-option :key="area.id" :value="area.value" :label="calcCpu(area)" v-for="area in cpuList">
              {{area.value}}{{lang.cores}}
            </t-option>
          </t-select>
        </t-form-item>
        <!-- 内存 -->
        <t-form-item :label="`${lang.memory}（${memory_unit}）`" class="required limit-bw">
          <t-form-item v-if="limitMemoryType && limitMemoryType === 'radio'" name="memory" :rules="[
        { required: true, message: `${lang.select}${lang.memory}`, type: 'error' },]" v-model="lineForm"
            class="mul-select" :required-mark="false">
            <t-select v-model="lineForm.memory" :placeholder="lang.select+ lang.memory" multiple>
              <t-option :key="area.id" :value="area.value" :label="calcMemory(area)" v-for="area in memoryList">
              </t-option>
            </t-select>
          </t-form-item>
          <template v-else>
            <t-form-item lable="" name="min_memory" :required-mark="false" :rules="calcReg(lang.memory,1,524288)">
              <t-input v-model="lineForm.min_memory" :placeholder="lang.min_value" @blur="changeMinMemory"></t-input>
            </t-form-item>
            <t-form-item lable="" name="max_memory" :required-mark="false" :rules="calcReg(lang.memory,1,524288)">
              <t-input v-model="lineForm.max_memory" :placeholder="lang.max_value" @blur="changeMaxMemory"></t-input>
            </t-form-item>
          </template>
        </t-form-item>
        <div class="com-f-btn">
          <t-button theme="primary" type="submit" :loading="submitLoading">{{lang.hold}}
          </t-button>
          <t-button theme="default" variant="base" @click="limitModel = false">{{lang.cancel}}</t-button>
        </div>
      </t-form>
    </t-dialog>
    <!-- 删除提示框 -->
    <t-dialog theme="warning" :header="delTit" :close-btn="false" :visible.sync="delVisible" class="deleteDialog">
      <p class="des" v-if="delType==='cycle'">{{lang.delete_tip}}</p>
      <p class="des" v-if="delType==='recommend'">{{lang.mf_tip41}}</p>
      <template slot="footer">
        <t-button theme="primary" @click="sureDelete" :loading="submitLoading">{{lang.sure}}</t-button>
        <t-button theme="default" @click="delVisible=false">{{lang.cancel}}</t-button>
      </template>
    </t-dialog>
  </com-config>
</div>
<script src="/plugins/server/mf_cloud/template/admin/lang/index.js"></script>
<script src="/plugins/server/mf_cloud/template/admin/api/mf_cloud.js"></script>
<script src="/plugins/server/mf_cloud/template/admin/js/mf_cloud.js"></script>
